2020-07-03 12:19:09,886 INFO org.springframework.boot.StartupInfoLogger [main] Starting StartPoint on NOLI125045 with PID 10148 (C:\sandbox\BKK_EnergiTjenester_SpringBoot\target\classes started by ronend in C:\sandbox\BKK_EnergiTjenester_SpringBoot)
2020-07-03 12:19:09,901 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2020-07-03 12:19:13,254 INFO org.springframework.scheduling.concurrent.ExecutorConfigurationSupport [main] Initializing ExecutorService 'taskScheduler'
2020-07-03 12:19:13,534 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER for existing sub-directories.
2020-07-03 12:19:13,639 INFO com.cts.controller.Controller [scheduling-1] Found 6 sub-directories - one directory per file format.
2020-07-03 12:19:13,641 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC.
2020-07-03 12:19:13,641 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\ for existing sub-directories.
2020-07-03 12:19:13,648 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for circutorPLCFormat - one for each meter data collection system .
2020-07-03 12:19:13,650 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1.
2020-07-03 12:19:13,671 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,672 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_2.
2020-07-03 12:19:13,676 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,677 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_3.
2020-07-03 12:19:13,684 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,684 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC in 0 seconds.
2020-07-03 12:19:13,687 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk.
2020-07-03 12:19:13,687 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\ for existing sub-directories.
2020-07-03 12:19:13,693 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for forbruksImportFormat - one for each meter data collection system .
2020-07-03 12:19:13,694 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_1.
2020-07-03 12:19:13,701 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,702 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_2.
2020-07-03 12:19:13,705 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,706 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_3.
2020-07-03 12:19:13,709 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,709 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk in 0 seconds.
2020-07-03 12:19:13,709 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV.
2020-07-03 12:19:13,709 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\ for existing sub-directories.
2020-07-03 12:19:13,715 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VBVFormat - one for each meter data collection system .
2020-07-03 12:19:13,716 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_1.
2020-07-03 12:19:13,731 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,769 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_2.
2020-07-03 12:19:13,794 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,794 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_3.
2020-07-03 12:19:13,853 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,853 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV in 0 seconds.
2020-07-03 12:19:13,853 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT.
2020-07-03 12:19:13,854 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\ for existing sub-directories.
2020-07-03 12:19:13,866 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VTFormat - one for each meter data collection system .
2020-07-03 12:19:13,868 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_1.
2020-07-03 12:19:13,889 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,890 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_2.
2020-07-03 12:19:13,895 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,896 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_3.
2020-07-03 12:19:13,913 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,913 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT in 0 seconds.
2020-07-03 12:19:13,915 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus.
2020-07-03 12:19:13,917 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\ for existing sub-directories.
2020-07-03 12:19:13,925 INFO com.cts.controller.Controller [scheduling-1] Found 5 sub-folders for mBusFormat - one for each meter data collection system .
2020-07-03 12:19:13,925 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_1.
2020-07-03 12:19:13,928 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,928 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_2.
2020-07-03 12:19:13,932 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,933 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_3.
2020-07-03 12:19:13,939 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:13,939 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Paradishagen.
2020-07-03 12:19:13,948 INFO org.springframework.boot.StartupInfoLogger [main] Started StartPoint in 5.269 seconds (JVM running for 7.064)
2020-07-03 12:19:13,973 INFO com.cts.controller.Controller [scheduling-1] Found 1 new input file/s.
2020-07-03 12:19:13,974 INFO com.cts.controller.Controller [scheduling-1] Found input file: test1meter_TimestampRead_1593771553945.txt.
2020-07-03 12:19:13,985 INFO com.cts.generator.ProcessInput [scheduling-1] Start processing input file test1meter_TimestampRead_1593771553945.txt.
2020-07-03 12:19:13,990 INFO com.cts.ioutils.InputFileReader [scheduling-1] Starting to read test1meter_TimestampRead_1593771553945.txt.
2020-07-03 12:19:14,030 INFO com.cts.ioutils.InputFileReader [scheduling-1] Completed reading. Total rows read = 91.
2020-07-03 12:19:14,038 INFO com.cts.generator.ProcessInput [scheduling-1] Collected 91 input rows.
2020-07-03 12:19:14,039 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct date format.
2020-07-03 12:19:14,257 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2020-07-03 12:19:14,347 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Completed checking 91 rows, out of which 91 have correct date format.
2020-07-03 12:19:14,349 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Checked date for 91 rows in less than a second.
2020-07-03 12:19:14,349 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct number format.
2020-07-03 12:19:14,354 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Completed checking 91 rows, out of which 91 have correct number format.
2020-07-03 12:19:14,354 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Checked number for 91 rows in less than a second.
2020-07-03 12:19:14,354 INFO com.cts.generator.ProcessInput [scheduling-1] Received 91 input rows, will check for an entry in customer for distinct meters in the input.
2020-07-03 12:19:14,361 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Starting to check for Customer record.
2020-07-03 12:19:15,359 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2020-07-03 12:19:35,213 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Found 1 distinct meters. Will check for a Customer registry for each.
2020-07-03 12:19:35,252 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Could not find meter 9680 in the base of previously checked meters, will try to get details by API call to ISCU.
2020-07-03 12:19:36,128 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Got meter details for meter 9680, UNIT kWh from ISCU.
2020-07-03 12:19:36,129 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] will try to insert meter 9680, unit kWh,to local H2 database.
2020-07-03 12:19:36,132 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Inserted meter 9680, UNIT kWh to the H2 database.
2020-07-03 12:19:36,133 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] So far checked 1 meters. Out of which 1 has Customer entry.
2020-07-03 12:19:36,133 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Time to check 1 meters =  0 seconds.
2020-07-03 12:19:36,133 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Completed check for entry in Customer, found 1 meters which have a Customer record.
2020-07-03 12:19:36,133 INFO com.cts.generator.ProcessInput [scheduling-1] proceeding to process 91 input rows.
2020-07-03 12:19:36,133 INFO com.cts.generator.ProcessInput [scheduling-1] Getting necessary details for mBusFormat.
2020-07-03 12:19:36,140 INFO com.cts.generator.ProcessInput [scheduling-1] Necessary details collected for 91 meters out of a total of 91 meters.
2020-07-03 12:19:36,151 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] starting to assign productType from Customer.
2020-07-03 12:19:36,158 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Checking if meter 9680 exists in base of previously checked meters.
2020-07-03 12:19:36,159 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Could not find meter 9680 in the base of previously checked meters, will try to get details by API call to ISCU.
2020-07-03 12:19:36,312 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Got requested details for meter 9680, productType ActiveEnergy, from API call.
2020-07-03 12:19:36,312 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Will try to insert meter 9680, detail ActiveEnergy, to local DB.
2020-07-03 12:19:36,313 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Inserted meterid = 9680, detail =  ActiveEnergy into H2 local database
2020-07-03 12:19:36,314 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Completed to retrieve productType for 1 meters out of 1 total distinct meters.
2020-07-03 12:19:36,314 INFO com.cts.generator.ProcessInput [scheduling-1] Will process 1 records for gs2 file - mBusFormat.
2020-07-03 12:19:37,426 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 792 day stands for meter 9680. Last stand date from DB is 2018-04-01T00:00:00.000+02:00, current stand date is 2020-06-01T00:00:37.000+02:00. Will create day stands for 792 days.
2020-07-03 12:19:37,514 INFO com.cts.generator.ProcessInput [scheduling-1] Created hourlyVolume GS2 file from input.
2020-07-03 12:19:37,517 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Starting writeOutput to print LastHourlyStand.
2020-07-03 12:19:37,528 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Completed writeOutput.
2020-07-03 12:19:37,528 INFO com.cts.controller.Controller [scheduling-1] GS2 file for input file test1meter_TimestampRead_1593771553945.txt written to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Paradishagen\Processed\.
2020-07-03 12:19:37,529 INFO com.cts.controller.Controller [scheduling-1] Starting to move used input files to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Paradishagen\Used\.
2020-07-03 12:19:37,540 INFO com.cts.utils.MoveUsedInputFilesToUsedFolder [scheduling-1] test1meter_TimestampRead_1593771553945.txt moved to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Paradishagen\Used\ .
2020-07-03 12:19:37,540 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 24 seconds.
2020-07-03 12:19:37,540 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-07-03 12:19:37,540 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Test.
2020-07-03 12:19:37,542 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:37,542 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus in 24 seconds.
2020-07-03 12:19:37,543 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde.
2020-07-03 12:19:37,543 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\ for existing sub-directories.
2020-07-03 12:19:37,547 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for gamleAnleggFormat - one for each meter data collection system .
2020-07-03 12:19:37,548 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_1.
2020-07-03 12:19:37,549 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:37,550 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_2.
2020-07-03 12:19:37,552 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:37,552 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_3.
2020-07-03 12:19:37,554 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-07-03 12:19:37,554 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde in 24 seconds.
2020-07-03 12:19:37,555 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 24 seconds.
2020-07-03 12:19:37,555 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
