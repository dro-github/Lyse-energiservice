2020-06-22 08:30:09,258 INFO org.springframework.boot.StartupInfoLogger [main] Starting StartPoint on NOLI125045 with PID 27296 (C:\sandbox\BKK_EnergiTjenester_SpringBoot\target\classes started by ronend in C:\sandbox\BKK_EnergiTjenester_SpringBoot)
2020-06-22 08:30:09,268 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2020-06-22 08:30:10,560 INFO org.springframework.scheduling.concurrent.ExecutorConfigurationSupport [main] Initializing ExecutorService 'taskScheduler'
2020-06-22 08:30:10,605 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER for existing sub-directories.
2020-06-22 08:30:10,609 INFO org.springframework.boot.StartupInfoLogger [main] Started StartPoint in 2.172 seconds (JVM running for 3.427)
2020-06-22 08:30:10,618 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2020-06-22 08:30:10,630 INFO com.cts.controller.Controller [scheduling-1] Found 6 sub-directories - one directory per file format.
2020-06-22 08:30:10,631 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC.
2020-06-22 08:30:10,631 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\ for existing sub-directories.
2020-06-22 08:30:10,636 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for circutorPLCFormat - one for each meter data collection system .
2020-06-22 08:30:10,637 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1.
2020-06-22 08:30:10,645 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,646 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_2.
2020-06-22 08:30:10,648 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,649 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_3.
2020-06-22 08:30:10,651 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,653 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC in 0 seconds.
2020-06-22 08:30:10,653 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk.
2020-06-22 08:30:10,653 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\ for existing sub-directories.
2020-06-22 08:30:10,657 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for forbruksImportFormat - one for each meter data collection system .
2020-06-22 08:30:10,658 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_1.
2020-06-22 08:30:10,660 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,660 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_2.
2020-06-22 08:30:10,662 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,662 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_3.
2020-06-22 08:30:10,664 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,664 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk in 0 seconds.
2020-06-22 08:30:10,665 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV.
2020-06-22 08:30:10,665 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\ for existing sub-directories.
2020-06-22 08:30:10,669 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VBVFormat - one for each meter data collection system .
2020-06-22 08:30:10,670 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_1.
2020-06-22 08:30:10,671 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,672 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_2.
2020-06-22 08:30:10,674 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,675 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_3.
2020-06-22 08:30:10,677 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,677 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV in 0 seconds.
2020-06-22 08:30:10,677 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT.
2020-06-22 08:30:10,677 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\ for existing sub-directories.
2020-06-22 08:30:10,681 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VTFormat - one for each meter data collection system .
2020-06-22 08:30:10,681 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_1.
2020-06-22 08:30:10,683 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,683 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_2.
2020-06-22 08:30:10,685 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,685 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_3.
2020-06-22 08:30:10,687 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,687 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT in 0 seconds.
2020-06-22 08:30:10,687 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus.
2020-06-22 08:30:10,687 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\ for existing sub-directories.
2020-06-22 08:30:10,691 INFO com.cts.controller.Controller [scheduling-1] Found 4 sub-folders for mBusFormat - one for each meter data collection system .
2020-06-22 08:30:10,692 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_1.
2020-06-22 08:30:10,694 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,694 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_2.
2020-06-22 08:30:10,696 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,697 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_3.
2020-06-22 08:30:10,699 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:10,699 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Test.
2020-06-22 08:30:10,718 INFO com.cts.controller.Controller [scheduling-1] Found 1 new input file/s.
2020-06-22 08:30:10,719 INFO com.cts.controller.Controller [scheduling-1] Found input file: bus_1_TimestampRead_1592807410704.txt.
2020-06-22 08:30:10,722 INFO com.cts.generator.ProcessInput [scheduling-1] Start processing input file bus_1_TimestampRead_1592807410704.txt.
2020-06-22 08:30:10,724 INFO com.cts.ioutils.InputFileReader [scheduling-1] Starting to read bus_1_TimestampRead_1592807410704.txt.
2020-06-22 08:30:10,727 INFO com.cts.ioutils.InputFileReader [scheduling-1] Completed reading. Total rows read = 3.
2020-06-22 08:30:10,728 INFO com.cts.generator.ProcessInput [scheduling-1] Collected 3 input rows.
2020-06-22 08:30:10,730 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct date format.
2020-06-22 08:30:10,908 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Completed checking 3 rows, out of which 3 have correct date format.
2020-06-22 08:30:10,909 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Checked date for 3 rows in less than a second.
2020-06-22 08:30:10,909 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct number format.
2020-06-22 08:30:10,915 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Completed checking 3 rows, out of which 3 have correct number format.
2020-06-22 08:30:10,915 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Checked number for 3 rows in less than a second.
2020-06-22 08:30:10,916 INFO com.cts.generator.ProcessInput [scheduling-1] Received 3 input rows, will check for an entry in customer for distinct meters in the input.
2020-06-22 08:30:10,920 INFO com.cts.nanoMeteringGateway.CheckUnitInNanoMetering [scheduling-1] Starting to check for Customer record.
2020-06-22 08:30:11,111 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2020-06-22 08:30:13,547 INFO com.cts.nanoMeteringGateway.CheckUnitInNanoMetering [scheduling-1] Found 3 distinct meters. Will check for a Customer registry for each.
2020-06-22 08:30:13,574 INFO com.cts.nanoMeteringGateway.CheckUnitInNanoMetering [scheduling-1] Got meter details for meter 5706567274344770, UNIT kVArh, from internal local H2 DB.
2020-06-22 08:30:13,574 INFO com.cts.nanoMeteringGateway.CheckUnitInNanoMetering [scheduling-1] Got meter details for meter 5706567274516542, UNIT kWh, from internal local H2 DB.
2020-06-22 08:30:13,574 INFO com.cts.nanoMeteringGateway.CheckUnitInNanoMetering [scheduling-1] Got meter details for meter 5706567274787577, UNIT kVArh, from internal local H2 DB.
2020-06-22 08:30:13,575 INFO com.cts.nanoMeteringGateway.CheckUnitInNanoMetering [scheduling-1] So far checked 3 meters. Out of which 3 has Customer entry.
2020-06-22 08:30:13,575 INFO com.cts.nanoMeteringGateway.CheckUnitInNanoMetering [scheduling-1] Time to check 3 meters =  0 seconds.
2020-06-22 08:30:13,575 INFO com.cts.nanoMeteringGateway.CheckUnitInNanoMetering [scheduling-1] Completed check for entry in Customer, found 3 meters which have a Customer record.
2020-06-22 08:30:13,575 INFO com.cts.generator.ProcessInput [scheduling-1] proceeding to process 3 input rows.
2020-06-22 08:30:13,575 INFO com.cts.generator.ProcessInput [scheduling-1] Getting necessary details for mBusFormat.
2020-06-22 08:30:13,578 INFO com.cts.generator.ProcessInput [scheduling-1] Necessary details collected for 3 meters out of a total of 3 meters.
2020-06-22 08:30:13,582 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] starting to assign productType from Customer.
2020-06-22 08:30:13,587 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Checking if meter 5706567274344770 exists in base of previously checked meters.
2020-06-22 08:30:13,588 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Found meter 5706567274344770, productType ReactiveEnergy, in in base of previously checked meters.
2020-06-22 08:30:13,588 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Checking if meter 5706567274516542 exists in base of previously checked meters.
2020-06-22 08:30:13,588 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Found meter 5706567274516542, productType ActiveEnergy, in in base of previously checked meters.
2020-06-22 08:30:13,589 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Checking if meter 5706567274787577 exists in base of previously checked meters.
2020-06-22 08:30:13,589 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Found meter 5706567274787577, productType ReactiveEnergy, in in base of previously checked meters.
2020-06-22 08:30:13,589 INFO com.cts.utils.InitiateMappingMeterToDetails [scheduling-1] Completed to retrieve productType for 3 meters out of 3 total distinct meters.
2020-06-22 08:30:13,589 INFO com.cts.generator.ProcessInput [scheduling-1] Will process 3 records for gs2 file - mBusFormat.
2020-06-22 08:30:15,239 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 1 day stands for meter 5706567274344770. Last stand date from DB is 2019-02-02T00:00:00.000+01:00, current stand date is 2019-02-03T02:00:00.000+01:00. Will create day stands for 1 days.
2020-06-22 08:30:15,620 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 1 day stands for meter 5706567274516542. Last stand date from DB is 2019-02-02T00:00:00.000+01:00, current stand date is 2019-02-03T02:00:00.000+01:00. Will create day stands for 1 days.
2020-06-22 08:30:17,384 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 1 day stands for meter 5706567274787577. Last stand date from DB is 2019-02-02T00:00:00.000+01:00, current stand date is 2019-02-03T02:00:00.000+01:00. Will create day stands for 1 days.
2020-06-22 08:30:17,387 INFO com.cts.generator.ProcessInput [scheduling-1] Created hourlyVolume GS2 file from input.
2020-06-22 08:30:17,393 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Starting writeOutput to print LastHourlyStand.
2020-06-22 08:30:17,406 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Completed writeOutput.
2020-06-22 08:30:17,408 INFO com.cts.controller.Controller [scheduling-1] GS2 file for input file bus_1_TimestampRead_1592807410704.txt written to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Test\Processed\.
2020-06-22 08:30:17,408 INFO com.cts.controller.Controller [scheduling-1] Starting to move used input files to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Test\Used\.
2020-06-22 08:30:17,417 INFO com.cts.utils.MoveUsedInputFilesToUsedFolder [scheduling-1] bus_1_TimestampRead_1592807410704.txt moved to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Test\Used\ .
2020-06-22 08:30:17,417 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 6 seconds.
2020-06-22 08:30:17,417 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-06-22 08:30:17,417 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus in 6 seconds.
2020-06-22 08:30:17,418 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde.
2020-06-22 08:30:17,418 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\ for existing sub-directories.
2020-06-22 08:30:17,422 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for gamleAnleggFormat - one for each meter data collection system .
2020-06-22 08:30:17,422 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_1.
2020-06-22 08:30:17,424 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:17,424 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_2.
2020-06-22 08:30:17,426 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:17,426 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_3.
2020-06-22 08:30:17,428 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-06-22 08:30:17,428 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde in 6 seconds.
2020-06-22 08:30:17,429 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 6 seconds.
2020-06-22 08:30:17,429 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
