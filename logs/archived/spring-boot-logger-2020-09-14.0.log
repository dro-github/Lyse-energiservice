2020-09-14 09:17:48,720 INFO org.springframework.boot.StartupInfoLogger [main] Starting StartPoint on NOLI125045 with PID 22672 (C:\sandbox\BKK_EnergiTjenester_SpringBoot\target\classes started by ronend in C:\sandbox\BKK_EnergiTjenester_SpringBoot)
2020-09-14 09:17:48,730 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2020-09-14 09:17:50,087 INFO org.springframework.scheduling.concurrent.ExecutorConfigurationSupport [main] Initializing ExecutorService 'taskScheduler'
2020-09-14 09:17:50,145 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER for existing sub-directories.
2020-09-14 09:17:50,149 INFO org.springframework.boot.StartupInfoLogger [main] Started StartPoint in 2.422 seconds (JVM running for 3.424)
2020-09-14 09:17:50,160 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2020-09-14 09:17:50,188 INFO com.cts.controller.Controller [scheduling-1] Found 6 sub-directories - one directory per file format.
2020-09-14 09:17:50,188 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC.
2020-09-14 09:17:50,189 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\ for existing sub-directories.
2020-09-14 09:17:50,194 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for circutorPLCFormat - one for each meter data collection system .
2020-09-14 09:17:50,194 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1.
2020-09-14 09:17:50,215 INFO com.cts.controller.Controller [scheduling-1] Found 1 new input file/s.
2020-09-14 09:17:50,215 INFO com.cts.controller.Controller [scheduling-1] Found input file: Test_circutorplc_API_TimestampRead_1600067870202.txt.
2020-09-14 09:17:50,217 INFO com.cts.generator.ProcessInput [scheduling-1] Start processing input file Test_circutorplc_API_TimestampRead_1600067870202.txt.
2020-09-14 09:17:50,220 INFO com.cts.ioutils.InputFileReader [scheduling-1] Starting to read Test_circutorplc_API_TimestampRead_1600067870202.txt.
2020-09-14 09:17:50,222 INFO com.cts.ioutils.InputFileReader [scheduling-1] Completed reading. Total rows read = 2.
2020-09-14 09:17:50,223 INFO com.cts.generator.ProcessInput [scheduling-1] Collected 2 input rows.
2020-09-14 09:17:50,224 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct date format.
2020-09-14 09:17:50,344 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Completed checking 2 rows, out of which 2 have correct date format.
2020-09-14 09:17:50,345 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Checked date for 2 rows in less than a second.
2020-09-14 09:17:50,347 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct number format.
2020-09-14 09:17:50,355 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Completed checking 2 rows, out of which 2 have correct number format.
2020-09-14 09:17:50,356 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Checked number for 2 rows in less than a second.
2020-09-14 09:17:50,357 INFO com.cts.generator.ProcessInput [scheduling-1] proceeding to process 2 input rows.
2020-09-14 09:17:50,360 INFO com.cts.generator.ProcessInput [scheduling-1] Getting necessary details for circutorPLCFormat.
2020-09-14 09:17:50,365 INFO com.cts.generator.ProcessInput [scheduling-1] Necessary details collected for 2 meters out of 2 meters received.
2020-09-14 09:17:50,374 INFO com.cts.utils.ExcludePulseCounters [scheduling-1] Getting list of pulse counters to be excluded.
2020-09-14 09:17:50,375 INFO com.cts.generator.ProcessInput [scheduling-1] Will process 2 records for gs2 file - circutorPLCFormat.
2020-09-14 09:17:50,748 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2020-09-14 09:18:06,786 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 4018 day stands for meter 12163501. Last stand date from DB is 2007-04-01T00:00:00.000+02:00, current stand date is 2018-04-01T00:00:00.000+02:00. Will create day stands for 4018 days.
2020-09-14 09:18:07,048 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] Could not get previous meter stand for meter NoSuchMeter from the DB, will use current stand as 1st stand ever.
2020-09-14 09:18:07,200 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] Could not get previous stand-date from the DB for meter NoSuchMeter. Will use 1st stand-date in file as 1st stand ever.
2020-09-14 09:18:07,201 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 1 day stands for meter NoSuchMeter. Last stand date from DB is 2018-04-01T00:00:00.000+02:00, current stand date is 2018-04-01T00:00:00.000+02:00. Will create day stands for 1 days.
2020-09-14 09:18:07,211 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Creating file for stand per hour for circutorPLCFormat.
2020-09-14 09:18:07,496 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Starting to check for Customer record.
2020-09-14 09:18:07,550 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Got meter details for meter 12163501, lev_punkt_id 2979, from internal local H2 DB.
2020-09-14 09:18:07,551 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Meter = 12163501, Objectid = 2979 - Gap of 96432 hours between last available stand_hour 2007-04-01T00:00:00.000+02:00 and current input hour 2018-04-01T00:00:00.000+02:00.
2020-09-14 09:18:07,551 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Last stand before the gap = 409.580, current stand after the gap = 76086.000.
2020-09-14 09:18:07,551 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Will fill the gap by equal distribution of total consumption in the gap divided by number of hours in the gap.
2020-09-14 09:18:07,726 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Could not get reading date from the DB for meter NoSuchMeter, will use 1st date in file as 1st date ever.
2020-09-14 09:18:07,877 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Could not get previous stand from the DB for meter NoSuchMeter, will use 1st stand in file as 1st stand ever.
2020-09-14 09:18:07,878 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Starting to check for Customer record.
2020-09-14 09:18:07,884 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Could not find meter NoSuchMeter in the base of previously checked meters, will try to get details by API call to ISCU.
2020-09-14 09:18:07,884 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Getting details For meter_id NoSuchMeter.
2020-09-14 09:18:07,885 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Full URL to the API is: https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/NoSuchMeter
2020-09-14 09:18:07,885 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] UserName is dro.
2020-09-14 09:18:07,885 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] PassWord is Sismaoffice39.
2020-09-14 09:18:07,885 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Executing: return yafrRestTemplate.getForEntity(https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/NoSuchMeter, MeterSetupV2.class).getBody();
2020-09-14 09:18:08,273 ERROR com.cts.customerGateway.MeterSetupClient [scheduling-1] could not get UNIT value for meter_id = NoSuchMeter. This meter is ignored. org.springframework.web.client.HttpClientErrorException:
org.springframework.web.client.HttpClientErrorException$NotFound: 404 Not Found: [No matching record for the given condition]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:113)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:170)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:112)
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:785)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:743)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:677)
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:345)
	at com.cts.customerGateway.MeterSetupClient.get(MeterSetupClient.java:77)
	at com.cts.customerGateway.GetDeliveryPoint.setDeliveryPoint(GetDeliveryPoint.java:40)
	at com.cts.customerGateway.GetDeliveryPoint.<init>(GetDeliveryPoint.java:28)
	at com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat.getDeliveryPointId(GeneratorForStandPerHourForCircutorPLCFormat.java:224)
	at com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat.getSeg2(GeneratorForStandPerHourForCircutorPLCFormat.java:107)
	at com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat.makeTimeSeriesPerMeter(GeneratorForStandPerHourForCircutorPLCFormat.java:84)
	at com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat.makeTimeSeries(GeneratorForStandPerHourForCircutorPLCFormat.java:79)
	at com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat.<init>(GeneratorForStandPerHourForCircutorPLCFormat.java:72)
	at com.cts.generator.GeneratorForLastHourlyStand.makeProfileReadings(GeneratorForLastHourlyStand.java:79)
	at com.cts.generator.GeneratorForLastHourlyStand.<init>(GeneratorForLastHourlyStand.java:58)
	at com.cts.generator.ProcessInput.createLastStandFile(ProcessInput.java:212)
	at com.cts.generator.ProcessInput.initiateDetailsList(ProcessInput.java:122)
	at com.cts.generator.ProcessInput.<init>(ProcessInput.java:75)
	at com.cts.controller.Controller.printOutput(Controller.java:207)
	at com.cts.controller.Controller.startProgram(Controller.java:143)
	at com.cts.controller.Controller.execute(Controller.java:114)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-14 09:18:08,275 WARN com.cts.customerGateway.GetDeliveryPoint [scheduling-1] could not get deliveryPoint value for meter_id = NoSuchMeter. This meter is ignored. Exception message below:
2020-09-14 09:18:08,276 ERROR com.cts.customerGateway.GetDeliveryPoint [scheduling-1] null
2020-09-14 09:18:08,277 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Could not get delivery point/Lev_punkt_id/Objectid for meter NoSuchMeter. Will not create stand per hour for this meter.
2020-09-14 09:18:08,280 INFO com.cts.generator.ProcessInput [scheduling-1] Created hourlyVolume GS2 file from input.
2020-09-14 09:18:08,286 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Starting writeOutput to print LastHourlyStand.
2020-09-14 09:18:08,324 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Completed writeOutput.
2020-09-14 09:18:08,324 INFO com.cts.controller.Controller [scheduling-1] GS2 file for input file Test_circutorplc_API_TimestampRead_1600067870202.txt written to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Processed\.
2020-09-14 09:18:08,325 INFO com.cts.controller.Controller [scheduling-1] Starting to move used input files to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Used\.
2020-09-14 09:18:08,331 INFO com.cts.utils.MoveUsedInputFilesToUsedFolder [scheduling-1] Test_circutorplc_API_TimestampRead_1600067870202.txt moved to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Used\ .
2020-09-14 09:18:08,331 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 18 seconds.
2020-09-14 09:18:08,331 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-09-14 09:18:08,331 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_2.
2020-09-14 09:18:08,333 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,333 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_3.
2020-09-14 09:18:08,335 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,335 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC in 18 seconds.
2020-09-14 09:18:08,335 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk.
2020-09-14 09:18:08,335 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\ for existing sub-directories.
2020-09-14 09:18:08,338 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for forbruksImportFormat - one for each meter data collection system .
2020-09-14 09:18:08,338 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_1.
2020-09-14 09:18:08,339 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,339 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_2.
2020-09-14 09:18:08,340 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,341 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_3.
2020-09-14 09:18:08,342 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,342 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk in 18 seconds.
2020-09-14 09:18:08,342 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV.
2020-09-14 09:18:08,342 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\ for existing sub-directories.
2020-09-14 09:18:08,345 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VBVFormat - one for each meter data collection system .
2020-09-14 09:18:08,346 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_1.
2020-09-14 09:18:08,347 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,347 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_2.
2020-09-14 09:18:08,349 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,349 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_3.
2020-09-14 09:18:08,350 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,350 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV in 18 seconds.
2020-09-14 09:18:08,350 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT.
2020-09-14 09:18:08,350 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\ for existing sub-directories.
2020-09-14 09:18:08,353 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VTFormat - one for each meter data collection system .
2020-09-14 09:18:08,353 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_1.
2020-09-14 09:18:08,354 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,354 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_2.
2020-09-14 09:18:08,356 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,356 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_3.
2020-09-14 09:18:08,357 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,357 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT in 18 seconds.
2020-09-14 09:18:08,357 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus.
2020-09-14 09:18:08,357 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\ for existing sub-directories.
2020-09-14 09:18:08,362 INFO com.cts.controller.Controller [scheduling-1] Found 5 sub-folders for mBusFormat - one for each meter data collection system .
2020-09-14 09:18:08,362 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_1.
2020-09-14 09:18:08,364 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,364 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_2.
2020-09-14 09:18:08,365 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,365 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_3.
2020-09-14 09:18:08,366 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,366 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Paradishagen.
2020-09-14 09:18:08,367 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,367 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Test.
2020-09-14 09:18:08,369 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,369 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus in 18 seconds.
2020-09-14 09:18:08,369 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde.
2020-09-14 09:18:08,369 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\ for existing sub-directories.
2020-09-14 09:18:08,372 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for gamleAnleggFormat - one for each meter data collection system .
2020-09-14 09:18:08,372 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_1.
2020-09-14 09:18:08,373 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,373 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_2.
2020-09-14 09:18:08,375 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,375 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_3.
2020-09-14 09:18:08,377 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:18:08,377 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde in 18 seconds.
2020-09-14 09:18:08,378 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 18 seconds.
2020-09-14 09:18:08,378 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-09-14 09:22:18,777 INFO org.springframework.boot.StartupInfoLogger [main] Starting StartPoint on NOLI125045 with PID 6768 (C:\sandbox\BKK_EnergiTjenester_SpringBoot\target\classes started by ronend in C:\sandbox\BKK_EnergiTjenester_SpringBoot)
2020-09-14 09:22:18,782 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2020-09-14 09:22:20,254 INFO org.springframework.scheduling.concurrent.ExecutorConfigurationSupport [main] Initializing ExecutorService 'taskScheduler'
2020-09-14 09:22:20,300 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER for existing sub-directories.
2020-09-14 09:22:20,303 INFO org.springframework.boot.StartupInfoLogger [main] Started StartPoint in 2.287 seconds (JVM running for 3.053)
2020-09-14 09:22:20,310 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2020-09-14 09:22:20,329 INFO com.cts.controller.Controller [scheduling-1] Found 6 sub-directories - one directory per file format.
2020-09-14 09:22:20,330 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC.
2020-09-14 09:22:20,331 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\ for existing sub-directories.
2020-09-14 09:22:20,336 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for circutorPLCFormat - one for each meter data collection system .
2020-09-14 09:22:20,336 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1.
2020-09-14 09:22:20,360 INFO com.cts.controller.Controller [scheduling-1] Found 1 new input file/s.
2020-09-14 09:22:20,361 INFO com.cts.controller.Controller [scheduling-1] Found input file: Test_circutorplc_API_TimestampRead_1600068140346.txt.
2020-09-14 09:22:20,364 INFO com.cts.generator.ProcessInput [scheduling-1] Start processing input file Test_circutorplc_API_TimestampRead_1600068140346.txt.
2020-09-14 09:22:20,366 INFO com.cts.ioutils.InputFileReader [scheduling-1] Starting to read Test_circutorplc_API_TimestampRead_1600068140346.txt.
2020-09-14 09:22:20,367 INFO com.cts.ioutils.InputFileReader [scheduling-1] Completed reading. Total rows read = 2.
2020-09-14 09:22:20,368 INFO com.cts.generator.ProcessInput [scheduling-1] Collected 2 input rows.
2020-09-14 09:22:20,369 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct date format.
2020-09-14 09:22:20,432 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Completed checking 2 rows, out of which 2 have correct date format.
2020-09-14 09:22:20,433 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Checked date for 2 rows in less than a second.
2020-09-14 09:22:20,433 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct number format.
2020-09-14 09:22:20,435 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Completed checking 2 rows, out of which 2 have correct number format.
2020-09-14 09:22:20,435 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Checked number for 2 rows in less than a second.
2020-09-14 09:22:20,436 INFO com.cts.generator.ProcessInput [scheduling-1] proceeding to process 2 input rows.
2020-09-14 09:22:20,436 INFO com.cts.generator.ProcessInput [scheduling-1] Getting necessary details for circutorPLCFormat.
2020-09-14 09:22:20,439 INFO com.cts.generator.ProcessInput [scheduling-1] Necessary details collected for 2 meters out of 2 meters received.
2020-09-14 09:22:20,443 INFO com.cts.utils.ExcludePulseCounters [scheduling-1] Getting list of pulse counters to be excluded.
2020-09-14 09:22:20,443 INFO com.cts.generator.ProcessInput [scheduling-1] Will process 2 records for gs2 file - circutorPLCFormat.
2020-09-14 09:22:20,752 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2020-09-14 09:22:36,530 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 4018 day stands for meter 12163501. Last stand date from DB is 2007-04-01T00:00:00.000+02:00, current stand date is 2018-04-01T00:00:00.000+02:00. Will create day stands for 4018 days.
2020-09-14 09:22:36,847 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] Could not get previous meter stand for meter NoSuchMeter from the DB, will use current stand as 1st stand ever.
2020-09-14 09:22:36,977 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] Could not get previous stand-date from the DB for meter NoSuchMeter. Will use 1st stand-date in file as 1st stand ever.
2020-09-14 09:22:36,979 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 1 day stands for meter NoSuchMeter. Last stand date from DB is 2018-04-01T00:00:00.000+02:00, current stand date is 2018-04-01T00:00:00.000+02:00. Will create day stands for 1 days.
2020-09-14 09:22:36,996 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Creating file for stand per hour for circutorPLCFormat.
2020-09-14 09:22:37,344 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Starting to check for Customer record.
2020-09-14 09:22:37,414 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Could not find meter 12163501 in the base of previously checked meters, will try to get details by API call to ISCU.
2020-09-14 09:22:37,414 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Getting details For meter_id 12163501.
2020-09-14 09:22:37,414 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Full URL to the API is: https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/12163501
2020-09-14 09:22:37,414 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] UserName is dro.
2020-09-14 09:22:37,414 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] PassWord is Sismaoffice39.
2020-09-14 09:22:37,415 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Executing: return yafrRestTemplate.getForEntity(https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/12163501, MeterSetupV2.class).getBody();
2020-09-14 09:22:37,768 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Got meter details for meter 12163501, lev_punkt_id 2979 from ISCU.
2020-09-14 09:22:37,769 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] will try to insert meter 12163501, deliveryPoint 2979,to local H2 database.
2020-09-14 09:22:37,776 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Inserted meter 12163501, lev_punkt_id 2979 to the H2 database.
2020-09-14 09:22:37,777 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Meter = 12163501, Objectid = 2979 - Gap of 96432 hours between last available stand_hour 2007-04-01T00:00:00.000+02:00 and current input hour 2018-04-01T00:00:00.000+02:00.
2020-09-14 09:22:37,778 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Last stand before the gap = 409.580, current stand after the gap = 76086.000.
2020-09-14 09:22:37,779 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Will fill the gap by equal distribution of total consumption in the gap divided by number of hours in the gap.
2020-09-14 09:22:37,974 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Could not get reading date from the DB for meter NoSuchMeter, will use 1st date in file as 1st date ever.
2020-09-14 09:22:38,099 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Could not get previous stand from the DB for meter NoSuchMeter, will use 1st stand in file as 1st stand ever.
2020-09-14 09:22:38,099 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Starting to check for Customer record.
2020-09-14 09:22:38,108 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Could not find meter NoSuchMeter in the base of previously checked meters, will try to get details by API call to ISCU.
2020-09-14 09:22:38,108 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Getting details For meter_id NoSuchMeter.
2020-09-14 09:22:38,108 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Full URL to the API is: https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/NoSuchMeter
2020-09-14 09:22:38,109 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] UserName is dro.
2020-09-14 09:22:38,109 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] PassWord is Sismaoffice39.
2020-09-14 09:22:38,109 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Executing: return yafrRestTemplate.getForEntity(https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/NoSuchMeter, MeterSetupV2.class).getBody();
2020-09-14 09:22:38,255 ERROR com.cts.customerGateway.MeterSetupClient [scheduling-1] could not get UNIT value for meter_id = NoSuchMeter. This meter is ignored. org.springframework.web.client.HttpClientErrorException:
org.springframework.web.client.HttpClientErrorException$NotFound: 404 Not Found: [No matching record for the given condition]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:113)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:170)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:112)
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:785)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:743)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:677)
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:345)
	at com.cts.customerGateway.MeterSetupClient.get(MeterSetupClient.java:77)
	at com.cts.customerGateway.GetDeliveryPoint.setDeliveryPoint(GetDeliveryPoint.java:40)
	at com.cts.customerGateway.GetDeliveryPoint.<init>(GetDeliveryPoint.java:28)
	at com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat.getDeliveryPointId(GeneratorForStandPerHourForCircutorPLCFormat.java:224)
	at com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat.getSeg2(GeneratorForStandPerHourForCircutorPLCFormat.java:107)
	at com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat.makeTimeSeriesPerMeter(GeneratorForStandPerHourForCircutorPLCFormat.java:84)
	at com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat.makeTimeSeries(GeneratorForStandPerHourForCircutorPLCFormat.java:79)
	at com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat.<init>(GeneratorForStandPerHourForCircutorPLCFormat.java:72)
	at com.cts.generator.GeneratorForLastHourlyStand.makeProfileReadings(GeneratorForLastHourlyStand.java:79)
	at com.cts.generator.GeneratorForLastHourlyStand.<init>(GeneratorForLastHourlyStand.java:58)
	at com.cts.generator.ProcessInput.createLastStandFile(ProcessInput.java:212)
	at com.cts.generator.ProcessInput.initiateDetailsList(ProcessInput.java:122)
	at com.cts.generator.ProcessInput.<init>(ProcessInput.java:75)
	at com.cts.controller.Controller.printOutput(Controller.java:207)
	at com.cts.controller.Controller.startProgram(Controller.java:143)
	at com.cts.controller.Controller.execute(Controller.java:114)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-14 09:22:38,256 WARN com.cts.customerGateway.GetDeliveryPoint [scheduling-1] could not get deliveryPoint value for meter_id = NoSuchMeter. This meter is ignored. Exception message below:
2020-09-14 09:22:38,256 ERROR com.cts.customerGateway.GetDeliveryPoint [scheduling-1] null
2020-09-14 09:22:38,257 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Could not get delivery point/Lev_punkt_id/Objectid for meter NoSuchMeter. Will not create stand per hour for this meter.
2020-09-14 09:22:38,260 INFO com.cts.generator.ProcessInput [scheduling-1] Created hourlyVolume GS2 file from input.
2020-09-14 09:22:38,265 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Starting writeOutput to print LastHourlyStand.
2020-09-14 09:22:38,303 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Completed writeOutput.
2020-09-14 09:22:38,303 INFO com.cts.controller.Controller [scheduling-1] GS2 file for input file Test_circutorplc_API_TimestampRead_1600068140346.txt written to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Processed\.
2020-09-14 09:22:38,304 INFO com.cts.controller.Controller [scheduling-1] Starting to move used input files to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Used\.
2020-09-14 09:22:38,314 INFO com.cts.utils.MoveUsedInputFilesToUsedFolder [scheduling-1] Test_circutorplc_API_TimestampRead_1600068140346.txt moved to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Used\ .
2020-09-14 09:22:38,314 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 18 seconds.
2020-09-14 09:22:38,314 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-09-14 09:22:38,314 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_2.
2020-09-14 09:22:38,316 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,316 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_3.
2020-09-14 09:22:38,318 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,318 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC in 18 seconds.
2020-09-14 09:22:38,318 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk.
2020-09-14 09:22:38,319 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\ for existing sub-directories.
2020-09-14 09:22:38,324 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for forbruksImportFormat - one for each meter data collection system .
2020-09-14 09:22:38,324 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_1.
2020-09-14 09:22:38,326 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,326 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_2.
2020-09-14 09:22:38,328 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,328 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_3.
2020-09-14 09:22:38,329 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,330 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk in 18 seconds.
2020-09-14 09:22:38,330 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV.
2020-09-14 09:22:38,330 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\ for existing sub-directories.
2020-09-14 09:22:38,332 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VBVFormat - one for each meter data collection system .
2020-09-14 09:22:38,332 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_1.
2020-09-14 09:22:38,334 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,334 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_2.
2020-09-14 09:22:38,335 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,335 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_3.
2020-09-14 09:22:38,336 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,337 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV in 18 seconds.
2020-09-14 09:22:38,337 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT.
2020-09-14 09:22:38,337 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\ for existing sub-directories.
2020-09-14 09:22:38,343 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VTFormat - one for each meter data collection system .
2020-09-14 09:22:38,344 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_1.
2020-09-14 09:22:38,346 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,347 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_2.
2020-09-14 09:22:38,349 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,349 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_3.
2020-09-14 09:22:38,351 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,352 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT in 18 seconds.
2020-09-14 09:22:38,352 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus.
2020-09-14 09:22:38,352 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\ for existing sub-directories.
2020-09-14 09:22:38,357 INFO com.cts.controller.Controller [scheduling-1] Found 5 sub-folders for mBusFormat - one for each meter data collection system .
2020-09-14 09:22:38,358 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_1.
2020-09-14 09:22:38,360 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,360 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_2.
2020-09-14 09:22:38,362 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,362 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_3.
2020-09-14 09:22:38,364 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,364 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Paradishagen.
2020-09-14 09:22:38,365 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,366 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Test.
2020-09-14 09:22:38,367 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,368 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus in 18 seconds.
2020-09-14 09:22:38,368 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde.
2020-09-14 09:22:38,368 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\ for existing sub-directories.
2020-09-14 09:22:38,371 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for gamleAnleggFormat - one for each meter data collection system .
2020-09-14 09:22:38,371 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_1.
2020-09-14 09:22:38,372 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,373 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_2.
2020-09-14 09:22:38,375 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,375 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_3.
2020-09-14 09:22:38,378 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 09:22:38,378 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde in 18 seconds.
2020-09-14 09:22:38,378 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 18 seconds.
2020-09-14 09:22:38,379 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-09-14 10:09:39,436 INFO org.springframework.boot.StartupInfoLogger [main] Starting StartPoint on NOLI125045 with PID 1820 (C:\sandbox\BKK_EnergiTjenester_SpringBoot\target\classes started by ronend in C:\sandbox\BKK_EnergiTjenester_SpringBoot)
2020-09-14 10:09:39,441 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2020-09-14 10:09:40,713 INFO org.springframework.scheduling.concurrent.ExecutorConfigurationSupport [main] Initializing ExecutorService 'taskScheduler'
2020-09-14 10:09:40,765 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER for existing sub-directories.
2020-09-14 10:09:40,769 INFO org.springframework.boot.StartupInfoLogger [main] Started StartPoint in 2.117 seconds (JVM running for 2.891)
2020-09-14 10:09:40,778 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2020-09-14 10:09:40,794 INFO com.cts.controller.Controller [scheduling-1] Found 6 sub-directories - one directory per file format.
2020-09-14 10:09:40,795 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC.
2020-09-14 10:09:40,795 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\ for existing sub-directories.
2020-09-14 10:09:40,798 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for circutorPLCFormat - one for each meter data collection system .
2020-09-14 10:09:40,799 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1.
2020-09-14 10:09:40,815 INFO com.cts.controller.Controller [scheduling-1] Found 1 new input file/s.
2020-09-14 10:09:40,816 INFO com.cts.controller.Controller [scheduling-1] Found input file: Test_circutorplc_API_TimestampRead_1600070980805.txt.
2020-09-14 10:09:40,818 INFO com.cts.generator.ProcessInput [scheduling-1] Start processing input file Test_circutorplc_API_TimestampRead_1600070980805.txt.
2020-09-14 10:09:40,820 INFO com.cts.ioutils.InputFileReader [scheduling-1] Starting to read Test_circutorplc_API_TimestampRead_1600070980805.txt.
2020-09-14 10:09:40,822 INFO com.cts.ioutils.InputFileReader [scheduling-1] Completed reading. Total rows read = 2.
2020-09-14 10:09:40,823 INFO com.cts.generator.ProcessInput [scheduling-1] Collected 2 input rows.
2020-09-14 10:09:40,823 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct date format.
2020-09-14 10:09:40,880 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Completed checking 2 rows, out of which 2 have correct date format.
2020-09-14 10:09:40,880 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Checked date for 2 rows in less than a second.
2020-09-14 10:09:40,880 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct number format.
2020-09-14 10:09:40,882 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Completed checking 2 rows, out of which 2 have correct number format.
2020-09-14 10:09:40,883 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Checked number for 2 rows in less than a second.
2020-09-14 10:09:40,883 INFO com.cts.generator.ProcessInput [scheduling-1] Received 2 input rows, will check for an entry in customer for distinct meters in the input.
2020-09-14 10:09:40,886 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Starting to check for Customer record.
2020-09-14 10:09:41,137 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2020-09-14 10:09:55,558 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Found 2 distinct meters. Will check for a Customer registry for each.
2020-09-14 10:09:55,585 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Could not find meter 12163501 in the base of previously checked meters, will try to get details by API call to ISCU.
2020-09-14 10:09:55,586 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Getting details For meter_id 12163501.
2020-09-14 10:09:55,586 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Full URL to the API is: https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/12163501
2020-09-14 10:09:55,586 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] UserName is dro.
2020-09-14 10:09:55,586 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] PassWord is Sismaoffice39.
2020-09-14 10:09:55,587 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Executing: return yafrRestTemplate.getForEntity(https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/12163501, MeterSetupV2.class).getBody();
2020-09-14 10:09:56,635 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Got meter details for meter 12163501, UNIT kWh from ISCU.
2020-09-14 10:09:56,635 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] will try to insert meter 12163501, unit kWh,to local H2 database.
2020-09-14 10:09:56,638 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Inserted meter 12163501, UNIT kWh to the H2 database.
2020-09-14 10:09:56,639 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Could not find meter NoSuchMeter in the base of previously checked meters, will try to get details by API call to ISCU.
2020-09-14 10:09:56,639 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Getting details For meter_id NoSuchMeter.
2020-09-14 10:09:56,639 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Full URL to the API is: https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/NoSuchMeter
2020-09-14 10:09:56,640 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] UserName is dro.
2020-09-14 10:09:56,640 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] PassWord is Sismaoffice39.
2020-09-14 10:09:56,640 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Executing: return yafrRestTemplate.getForEntity(https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/NoSuchMeter, MeterSetupV2.class).getBody();
2020-09-14 10:09:56,794 ERROR com.cts.customerGateway.MeterSetupClient [scheduling-1] could not get UNIT value for meter_id = NoSuchMeter. This meter is ignored. org.springframework.web.client.HttpClientErrorException:
org.springframework.web.client.HttpClientErrorException$NotFound: 404 Not Found: [No matching record for the given condition]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:113)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:170)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:112)
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:785)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:743)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:677)
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:345)
	at com.cts.customerGateway.MeterSetupClient.get(MeterSetupClient.java:77)
	at com.cts.customerGateway.CheckMeterInCustomer.hasCustomerEntry(CheckMeterInCustomer.java:80)
	at com.cts.customerGateway.CheckMeterInCustomer.getDistinctMetersInCustomer(CheckMeterInCustomer.java:59)
	at com.cts.customerGateway.CheckMeterInCustomer.filterInputRows(CheckMeterInCustomer.java:40)
	at com.cts.customerGateway.CheckMeterInCustomer.<init>(CheckMeterInCustomer.java:33)
	at com.cts.generator.ProcessInput.excludeMetersNotInCustomer(ProcessInput.java:88)
	at com.cts.generator.ProcessInput.<init>(ProcessInput.java:67)
	at com.cts.controller.Controller.printOutput(Controller.java:207)
	at com.cts.controller.Controller.startProgram(Controller.java:143)
	at com.cts.controller.Controller.execute(Controller.java:114)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-14 10:09:56,795 WARN com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] could not get UNIT value for meter_id = NoSuchMeter. This meter is ignored. General Exception. Exception message below:
2020-09-14 10:09:56,795 ERROR com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Unable to fetch UNIT.
java.lang.NullPointerException: null
	at com.cts.customerGateway.CheckMeterInCustomer.hasCustomerEntry(CheckMeterInCustomer.java:80)
	at com.cts.customerGateway.CheckMeterInCustomer.getDistinctMetersInCustomer(CheckMeterInCustomer.java:59)
	at com.cts.customerGateway.CheckMeterInCustomer.filterInputRows(CheckMeterInCustomer.java:40)
	at com.cts.customerGateway.CheckMeterInCustomer.<init>(CheckMeterInCustomer.java:33)
	at com.cts.generator.ProcessInput.excludeMetersNotInCustomer(ProcessInput.java:88)
	at com.cts.generator.ProcessInput.<init>(ProcessInput.java:67)
	at com.cts.controller.Controller.printOutput(Controller.java:207)
	at com.cts.controller.Controller.startProgram(Controller.java:143)
	at com.cts.controller.Controller.execute(Controller.java:114)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-14 10:09:56,796 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] So far checked 2 meters. Out of which 1 has Customer entry.
2020-09-14 10:09:56,796 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Time to check 2 meters =  1 seconds.
2020-09-14 10:09:56,796 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Completed check for entry in Customer, found 1 meters which have a Customer record.
2020-09-14 10:09:56,796 INFO com.cts.generator.ProcessInput [scheduling-1] proceeding to process 1 input rows.
2020-09-14 10:09:56,796 INFO com.cts.generator.ProcessInput [scheduling-1] Getting necessary details for circutorPLCFormat.
2020-09-14 10:09:56,800 INFO com.cts.generator.ProcessInput [scheduling-1] Necessary details collected for 1 meters out of 1 meters received.
2020-09-14 10:09:56,804 INFO com.cts.utils.ExcludePulseCounters [scheduling-1] Getting list of pulse counters to be excluded.
2020-09-14 10:09:56,804 INFO com.cts.generator.ProcessInput [scheduling-1] Will process 1 records for gs2 file - circutorPLCFormat.
2020-09-14 10:09:57,324 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 4018 day stands for meter 12163501. Last stand date from DB is 2007-04-01T00:00:00.000+02:00, current stand date is 2018-04-01T00:00:00.000+02:00. Will create day stands for 4018 days.
2020-09-14 10:09:57,460 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Creating file for stand per hour for circutorPLCFormat.
2020-09-14 10:09:57,741 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Starting to check for Customer record.
2020-09-14 10:09:57,748 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Got meter details for meter 12163501, lev_punkt_id 2979, from internal local H2 DB.
2020-09-14 10:09:57,749 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Meter = 12163501, Objectid = 2979 - Gap of 96432 hours between last available stand_hour 2007-04-01T00:00:00.000+02:00 and current input hour 2018-04-01T00:00:00.000+02:00.
2020-09-14 10:09:57,749 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Last stand before the gap = 409.580, current stand after the gap = 76086.000.
2020-09-14 10:09:57,750 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Will fill the gap by equal distribution of total consumption in the gap divided by number of hours in the gap.
2020-09-14 10:09:57,800 INFO com.cts.generator.ProcessInput [scheduling-1] Created hourlyVolume GS2 file from input.
2020-09-14 10:09:57,801 INFO com.cts.generator.ProcessInput [scheduling-1] Input file contains 1 un-processable rows. Will write deviation report for those rows.
2020-09-14 10:09:57,803 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Starting writeOutput to print LastHourlyStand.
2020-09-14 10:09:57,833 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Completed writeOutput.
2020-09-14 10:09:57,834 INFO com.cts.controller.Controller [scheduling-1] GS2 file for input file Test_circutorplc_API_TimestampRead_1600070980805.txt written to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Processed\.
2020-09-14 10:09:57,836 INFO com.cts.ioutils.DeviationReportWriter [scheduling-1] Publish Deviation Report = TRUE
2020-09-14 10:09:57,840 INFO com.cts.ioutils.DeviationReportWriter [scheduling-1] AvviksRapport skrevet til: C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Failed\Test_circutorplc_API_Failed_1600070980805.txt
2020-09-14 10:09:57,840 INFO com.cts.controller.Controller [scheduling-1] Starting to move used input files to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Used\.
2020-09-14 10:09:57,846 INFO com.cts.utils.MoveUsedInputFilesToUsedFolder [scheduling-1] Test_circutorplc_API_TimestampRead_1600070980805.txt moved to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Used\ .
2020-09-14 10:09:57,847 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 17 seconds.
2020-09-14 10:09:57,847 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-09-14 10:09:57,847 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_2.
2020-09-14 10:09:57,849 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,849 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_3.
2020-09-14 10:09:57,851 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,852 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC in 17 seconds.
2020-09-14 10:09:57,852 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk.
2020-09-14 10:09:57,852 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\ for existing sub-directories.
2020-09-14 10:09:57,856 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for forbruksImportFormat - one for each meter data collection system .
2020-09-14 10:09:57,856 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_1.
2020-09-14 10:09:57,858 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,858 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_2.
2020-09-14 10:09:57,859 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,859 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_3.
2020-09-14 10:09:57,861 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,861 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk in 17 seconds.
2020-09-14 10:09:57,862 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV.
2020-09-14 10:09:57,862 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\ for existing sub-directories.
2020-09-14 10:09:57,865 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VBVFormat - one for each meter data collection system .
2020-09-14 10:09:57,865 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_1.
2020-09-14 10:09:57,866 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,866 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_2.
2020-09-14 10:09:57,868 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,868 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_3.
2020-09-14 10:09:57,870 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,870 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV in 17 seconds.
2020-09-14 10:09:57,871 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT.
2020-09-14 10:09:57,871 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\ for existing sub-directories.
2020-09-14 10:09:57,875 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VTFormat - one for each meter data collection system .
2020-09-14 10:09:57,875 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_1.
2020-09-14 10:09:57,877 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,877 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_2.
2020-09-14 10:09:57,878 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,879 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_3.
2020-09-14 10:09:57,880 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,881 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT in 17 seconds.
2020-09-14 10:09:57,881 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus.
2020-09-14 10:09:57,881 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\ for existing sub-directories.
2020-09-14 10:09:57,887 INFO com.cts.controller.Controller [scheduling-1] Found 5 sub-folders for mBusFormat - one for each meter data collection system .
2020-09-14 10:09:57,887 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_1.
2020-09-14 10:09:57,889 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,890 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_2.
2020-09-14 10:09:57,892 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,892 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_3.
2020-09-14 10:09:57,894 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,894 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Paradishagen.
2020-09-14 10:09:57,895 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,895 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Test.
2020-09-14 10:09:57,896 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,897 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus in 17 seconds.
2020-09-14 10:09:57,897 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde.
2020-09-14 10:09:57,897 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\ for existing sub-directories.
2020-09-14 10:09:57,899 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for gamleAnleggFormat - one for each meter data collection system .
2020-09-14 10:09:57,900 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_1.
2020-09-14 10:09:57,901 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,902 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_2.
2020-09-14 10:09:57,903 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,904 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_3.
2020-09-14 10:09:57,905 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 10:09:57,905 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde in 17 seconds.
2020-09-14 10:09:57,906 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 17 seconds.
2020-09-14 10:09:57,906 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-09-14 16:10:15,338 INFO org.springframework.boot.StartupInfoLogger [main] Starting StartPoint on NOLI125045 with PID 12416 (C:\sandbox\BKK_EnergiTjenester_SpringBoot\target\classes started by ronend in C:\sandbox\BKK_EnergiTjenester_SpringBoot)
2020-09-14 16:10:15,342 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2020-09-14 16:10:16,837 INFO org.springframework.scheduling.concurrent.ExecutorConfigurationSupport [main] Initializing ExecutorService 'taskScheduler'
2020-09-14 16:10:16,889 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER for existing sub-directories.
2020-09-14 16:10:16,897 INFO org.springframework.boot.StartupInfoLogger [main] Started StartPoint in 2.358 seconds (JVM running for 3.197)
2020-09-14 16:10:16,908 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2020-09-14 16:10:16,937 INFO com.cts.controller.Controller [scheduling-1] Found 6 sub-directories - one directory per file format.
2020-09-14 16:10:16,938 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC.
2020-09-14 16:10:16,939 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\ for existing sub-directories.
2020-09-14 16:10:16,943 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for circutorPLCFormat - one for each meter data collection system .
2020-09-14 16:10:16,943 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1.
2020-09-14 16:10:16,967 INFO com.cts.controller.Controller [scheduling-1] Found 1 new input file/s.
2020-09-14 16:10:16,968 INFO com.cts.controller.Controller [scheduling-1] Found input file: Test_circutorplc_API_TimestampRead_1600092616951.txt.
2020-09-14 16:10:16,971 INFO com.cts.generator.ProcessInput [scheduling-1] Start processing input file Test_circutorplc_API_TimestampRead_1600092616951.txt.
2020-09-14 16:10:16,974 INFO com.cts.ioutils.InputFileReader [scheduling-1] Starting to read Test_circutorplc_API_TimestampRead_1600092616951.txt.
2020-09-14 16:10:16,976 INFO com.cts.ioutils.InputFileReader [scheduling-1] Completed reading. Total rows read = 2.
2020-09-14 16:10:16,977 INFO com.cts.generator.ProcessInput [scheduling-1] Collected 2 input rows.
2020-09-14 16:10:16,977 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct date format.
2020-09-14 16:10:17,077 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Completed checking 2 rows, out of which 2 have correct date format.
2020-09-14 16:10:17,078 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Checked date for 2 rows in less than a second.
2020-09-14 16:10:17,088 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct number format.
2020-09-14 16:10:17,093 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Completed checking 2 rows, out of which 2 have correct number format.
2020-09-14 16:10:17,094 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Checked number for 2 rows in less than a second.
2020-09-14 16:10:17,095 INFO com.cts.generator.ProcessInput [scheduling-1] Received 2 input rows, will check for an entry in customer for distinct meters in the input.
2020-09-14 16:10:17,102 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Starting to check for Customer record.
2020-09-14 16:10:17,466 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2020-09-14 16:10:25,356 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Found 2 distinct meters. Will check for a Customer registry for each.
2020-09-14 16:10:25,380 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Got meter details for meter 12163501, UNIT kWh, from internal local H2 DB.
2020-09-14 16:10:25,381 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Could not find meter NoSuchMeter in the base of previously checked meters, will try to get details by API call to ISCU.
2020-09-14 16:10:25,382 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Getting details For meter_id NoSuchMeter.
2020-09-14 16:10:25,382 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Full URL to the API is: https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/NoSuchMeter
2020-09-14 16:10:25,382 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] UserName is dro.
2020-09-14 16:10:25,382 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] PassWord is Sismaoffice39.
2020-09-14 16:10:25,382 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Executing: return yafrRestTemplate.getForEntity(https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/NoSuchMeter, MeterSetupV2.class).getBody();
2020-09-14 16:10:25,998 ERROR com.cts.customerGateway.MeterSetupClient [scheduling-1] could not get UNIT value for meter_id = NoSuchMeter. This meter is ignored. org.springframework.web.client.HttpClientErrorException:
org.springframework.web.client.HttpClientErrorException$NotFound: 404 Not Found: [No matching record for the given condition]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:113)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:170)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:112)
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:785)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:743)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:677)
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:345)
	at com.cts.customerGateway.MeterSetupClient.get(MeterSetupClient.java:77)
	at com.cts.customerGateway.CheckMeterInCustomer.hasCustomerEntry(CheckMeterInCustomer.java:80)
	at com.cts.customerGateway.CheckMeterInCustomer.getDistinctMetersInCustomer(CheckMeterInCustomer.java:59)
	at com.cts.customerGateway.CheckMeterInCustomer.filterInputRows(CheckMeterInCustomer.java:40)
	at com.cts.customerGateway.CheckMeterInCustomer.<init>(CheckMeterInCustomer.java:33)
	at com.cts.generator.ProcessInput.excludeMetersNotInCustomer(ProcessInput.java:88)
	at com.cts.generator.ProcessInput.<init>(ProcessInput.java:67)
	at com.cts.controller.Controller.printOutput(Controller.java:207)
	at com.cts.controller.Controller.startProgram(Controller.java:143)
	at com.cts.controller.Controller.execute(Controller.java:114)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-09-14 16:10:25,999 WARN com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] could not get UNIT value for meter_id = NoSuchMeter. This meter is ignored. General Exception. Exception message below:
2020-09-14 16:10:26,000 ERROR com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Unable to fetch UNIT.
java.lang.NullPointerException: null
	at com.cts.customerGateway.CheckMeterInCustomer.hasCustomerEntry(CheckMeterInCustomer.java:80)
	at com.cts.customerGateway.CheckMeterInCustomer.getDistinctMetersInCustomer(CheckMeterInCustomer.java:59)
	at com.cts.customerGateway.CheckMeterInCustomer.filterInputRows(CheckMeterInCustomer.java:40)
	at com.cts.customerGateway.CheckMeterInCustomer.<init>(CheckMeterInCustomer.java:33)
	at com.cts.generator.ProcessInput.excludeMetersNotInCustomer(ProcessInput.java:88)
	at com.cts.generator.ProcessInput.<init>(ProcessInput.java:67)
	at com.cts.controller.Controller.printOutput(Controller.java:207)
	at com.cts.controller.Controller.startProgram(Controller.java:143)
	at com.cts.controller.Controller.execute(Controller.java:114)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-09-14 16:10:26,000 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] So far checked 2 meters. Out of which 1 has Customer entry.
2020-09-14 16:10:26,001 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Time to check 2 meters =  0 seconds.
2020-09-14 16:10:26,001 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Completed check for entry in Customer, found 1 meters which have a Customer record.
2020-09-14 16:10:26,001 INFO com.cts.generator.ProcessInput [scheduling-1] proceeding to process 1 input rows.
2020-09-14 16:10:26,002 INFO com.cts.generator.ProcessInput [scheduling-1] Getting necessary details for circutorPLCFormat.
2020-09-14 16:10:26,005 INFO com.cts.generator.ProcessInput [scheduling-1] Necessary details collected for 1 meters out of 1 meters received.
2020-09-14 16:10:26,008 INFO com.cts.utils.ExcludePulseCounters [scheduling-1] Getting list of pulse counters to be excluded.
2020-09-14 16:10:26,008 INFO com.cts.generator.ProcessInput [scheduling-1] Will process 1 records for gs2 file - circutorPLCFormat.
2020-09-14 16:10:26,466 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 4018 day stands for meter 12163501. Last stand date from DB is 2007-04-01T00:00:00.000+02:00, current stand date is 2018-04-01T00:00:00.000+02:00. Will create day stands for 4018 days.
2020-09-14 16:10:26,602 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Creating file for stand per hour for circutorPLCFormat.
2020-09-14 16:10:26,874 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Starting to check for Customer record.
2020-09-14 16:10:26,880 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Got meter details for meter 12163501, lev_punkt_id 2979, from internal local H2 DB.
2020-09-14 16:10:26,881 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Meter = 12163501, Objectid = 2979 - Gap of 96432 hours between last available stand_hour 2007-04-01T00:00:00.000+02:00 and current input hour 2018-04-01T00:00:00.000+02:00.
2020-09-14 16:10:26,881 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Last stand before the gap = 409.580, current stand after the gap = 76086.000.
2020-09-14 16:10:26,881 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Will fill the gap by equal distribution of total consumption in the gap divided by number of hours in the gap.
2020-09-14 16:10:26,935 INFO com.cts.generator.ProcessInput [scheduling-1] Created hourlyVolume GS2 file from input.
2020-09-14 16:10:26,936 INFO com.cts.generator.ProcessInput [scheduling-1] Input file contains 1 un-processable rows. Will write deviation report for those rows.
2020-09-14 16:10:26,938 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Starting writeOutput to print LastHourlyStand.
2020-09-14 16:10:26,972 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Completed writeOutput.
2020-09-14 16:10:26,972 INFO com.cts.controller.Controller [scheduling-1] GS2 file for input file Test_circutorplc_API_TimestampRead_1600092616951.txt written to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Processed\.
2020-09-14 16:10:26,974 INFO com.cts.ioutils.DeviationReportWriter [scheduling-1] Publish Deviation Report = TRUE
2020-09-14 16:10:26,979 INFO com.cts.ioutils.DeviationReportWriter [scheduling-1] AvviksRapport skrevet til: C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Failed\Test_circutorplc_API_Failed_1600092616951.txt
2020-09-14 16:10:26,979 INFO com.cts.controller.Controller [scheduling-1] Starting to move used input files to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Used\.
2020-09-14 16:10:26,986 INFO com.cts.utils.MoveUsedInputFilesToUsedFolder [scheduling-1] Test_circutorplc_API_TimestampRead_1600092616951.txt moved to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Used\ .
2020-09-14 16:10:26,986 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 10 seconds.
2020-09-14 16:10:26,986 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-09-14 16:10:26,986 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_2.
2020-09-14 16:10:26,988 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:26,988 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_3.
2020-09-14 16:10:26,990 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:26,990 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC in 10 seconds.
2020-09-14 16:10:26,990 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk.
2020-09-14 16:10:26,990 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\ for existing sub-directories.
2020-09-14 16:10:26,993 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for forbruksImportFormat - one for each meter data collection system .
2020-09-14 16:10:26,993 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_1.
2020-09-14 16:10:26,994 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:26,994 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_2.
2020-09-14 16:10:26,996 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:26,996 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_3.
2020-09-14 16:10:26,997 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:26,997 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk in 10 seconds.
2020-09-14 16:10:26,998 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV.
2020-09-14 16:10:26,998 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\ for existing sub-directories.
2020-09-14 16:10:27,000 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VBVFormat - one for each meter data collection system .
2020-09-14 16:10:27,000 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_1.
2020-09-14 16:10:27,002 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,002 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_2.
2020-09-14 16:10:27,003 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,003 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_3.
2020-09-14 16:10:27,005 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,005 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV in 10 seconds.
2020-09-14 16:10:27,005 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT.
2020-09-14 16:10:27,005 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\ for existing sub-directories.
2020-09-14 16:10:27,008 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VTFormat - one for each meter data collection system .
2020-09-14 16:10:27,008 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_1.
2020-09-14 16:10:27,009 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,009 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_2.
2020-09-14 16:10:27,010 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,011 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_3.
2020-09-14 16:10:27,012 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,013 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT in 10 seconds.
2020-09-14 16:10:27,013 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus.
2020-09-14 16:10:27,013 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\ for existing sub-directories.
2020-09-14 16:10:27,017 INFO com.cts.controller.Controller [scheduling-1] Found 5 sub-folders for mBusFormat - one for each meter data collection system .
2020-09-14 16:10:27,017 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_1.
2020-09-14 16:10:27,018 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,018 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_2.
2020-09-14 16:10:27,020 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,020 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_3.
2020-09-14 16:10:27,021 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,021 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Paradishagen.
2020-09-14 16:10:27,022 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,023 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Test.
2020-09-14 16:10:27,024 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,024 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus in 10 seconds.
2020-09-14 16:10:27,025 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde.
2020-09-14 16:10:27,025 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\ for existing sub-directories.
2020-09-14 16:10:27,027 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for gamleAnleggFormat - one for each meter data collection system .
2020-09-14 16:10:27,027 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_1.
2020-09-14 16:10:27,028 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,029 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_2.
2020-09-14 16:10:27,030 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,030 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_3.
2020-09-14 16:10:27,031 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:10:27,031 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde in 10 seconds.
2020-09-14 16:10:27,031 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 10 seconds.
2020-09-14 16:10:27,032 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-09-14 16:13:04,852 INFO org.springframework.boot.StartupInfoLogger [main] Starting StartPoint on NOLI125045 with PID 6216 (C:\sandbox\BKK_EnergiTjenester_SpringBoot\target\classes started by ronend in C:\sandbox\BKK_EnergiTjenester_SpringBoot)
2020-09-14 16:13:04,857 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2020-09-14 16:13:06,008 INFO org.springframework.scheduling.concurrent.ExecutorConfigurationSupport [main] Initializing ExecutorService 'taskScheduler'
2020-09-14 16:13:06,070 INFO org.springframework.boot.StartupInfoLogger [main] Started StartPoint in 1.923 seconds (JVM running for 2.648)
2020-09-14 16:13:06,067 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER for existing sub-directories.
2020-09-14 16:13:06,086 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2020-09-14 16:13:06,115 INFO com.cts.controller.Controller [scheduling-1] Found 6 sub-directories - one directory per file format.
2020-09-14 16:13:06,115 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC.
2020-09-14 16:13:06,116 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\ for existing sub-directories.
2020-09-14 16:13:06,122 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for circutorPLCFormat - one for each meter data collection system .
2020-09-14 16:13:06,123 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1.
2020-09-14 16:13:06,142 INFO com.cts.controller.Controller [scheduling-1] Found 1 new input file/s.
2020-09-14 16:13:06,143 INFO com.cts.controller.Controller [scheduling-1] Found input file: Test_circutorplc_API_TimestampRead_1600092786131.txt.
2020-09-14 16:13:06,145 INFO com.cts.generator.ProcessInput [scheduling-1] Start processing input file Test_circutorplc_API_TimestampRead_1600092786131.txt.
2020-09-14 16:13:06,146 INFO com.cts.ioutils.InputFileReader [scheduling-1] Starting to read Test_circutorplc_API_TimestampRead_1600092786131.txt.
2020-09-14 16:13:06,148 INFO com.cts.ioutils.InputFileReader [scheduling-1] Completed reading. Total rows read = 2.
2020-09-14 16:13:06,149 INFO com.cts.generator.ProcessInput [scheduling-1] Collected 2 input rows.
2020-09-14 16:13:06,150 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct date format.
2020-09-14 16:13:06,212 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Completed checking 2 rows, out of which 2 have correct date format.
2020-09-14 16:13:06,213 INFO com.cts.utils.VerifyDateFormat [scheduling-1] Checked date for 2 rows in less than a second.
2020-09-14 16:13:06,214 INFO com.cts.generator.ProcessInput [scheduling-1] Checking correct number format.
2020-09-14 16:13:06,227 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Completed checking 2 rows, out of which 2 have correct number format.
2020-09-14 16:13:06,227 INFO com.cts.utils.VerifyNumberFormat [scheduling-1] Checked number for 2 rows in less than a second.
2020-09-14 16:13:06,227 INFO com.cts.generator.ProcessInput [scheduling-1] Received 2 input rows, will check for an entry in customer for distinct meters in the input.
2020-09-14 16:13:06,232 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Starting to check for Customer record.
2020-09-14 16:13:06,487 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2020-09-14 16:13:14,257 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Found 2 distinct meters. Will check for a Customer registry for each.
2020-09-14 16:13:14,281 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Could not find meter 12163501 in the base of previously checked meters, will try to get details by API call to ISCU.
2020-09-14 16:13:14,281 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Getting details For meter_id 12163501.
2020-09-14 16:13:14,281 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Full URL to the API is: https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/12163501
2020-09-14 16:13:14,281 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] UserName is dro.
2020-09-14 16:13:14,281 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] PassWord is Sismaoffice39.
2020-09-14 16:13:14,282 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Executing: return yafrRestTemplate.getForEntity(https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/12163501, MeterSetupV2.class).getBody();
2020-09-14 16:13:14,964 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Got meter details for meter 12163501, UNIT kWh from ISCU.
2020-09-14 16:13:14,964 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] will try to insert meter 12163501, unit kWh,to local H2 database.
2020-09-14 16:13:14,967 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Inserted meter 12163501, UNIT kWh to the H2 database.
2020-09-14 16:13:14,968 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Could not find meter NoSuchMeter in the base of previously checked meters, will try to get details by API call to ISCU.
2020-09-14 16:13:14,969 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Getting details For meter_id NoSuchMeter.
2020-09-14 16:13:14,969 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Full URL to the API is: https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/NoSuchMeter
2020-09-14 16:13:14,969 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] UserName is dro.
2020-09-14 16:13:14,969 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] PassWord is Sismaoffice39.
2020-09-14 16:13:14,969 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Executing: return yafrRestTemplate.getForEntity(https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/NoSuchMeter, MeterSetupV2.class).getBody();
2020-09-14 16:13:15,115 ERROR com.cts.customerGateway.MeterSetupClient [scheduling-1] could not get UNIT value for meter_id = NoSuchMeter. This meter is ignored. org.springframework.web.client.HttpClientErrorException:
org.springframework.web.client.HttpClientErrorException$NotFound: 404 Not Found: [No matching record for the given condition]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:113)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:170)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:112)
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:785)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:743)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:677)
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:345)
	at com.cts.customerGateway.MeterSetupClient.get(MeterSetupClient.java:77)
	at com.cts.customerGateway.CheckMeterInCustomer.hasCustomerEntry(CheckMeterInCustomer.java:80)
	at com.cts.customerGateway.CheckMeterInCustomer.getDistinctMetersInCustomer(CheckMeterInCustomer.java:59)
	at com.cts.customerGateway.CheckMeterInCustomer.filterInputRows(CheckMeterInCustomer.java:40)
	at com.cts.customerGateway.CheckMeterInCustomer.<init>(CheckMeterInCustomer.java:33)
	at com.cts.generator.ProcessInput.excludeMetersNotInCustomer(ProcessInput.java:88)
	at com.cts.generator.ProcessInput.<init>(ProcessInput.java:67)
	at com.cts.controller.Controller.printOutput(Controller.java:207)
	at com.cts.controller.Controller.startProgram(Controller.java:143)
	at com.cts.controller.Controller.execute(Controller.java:114)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-09-14 16:13:15,117 WARN com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] could not get UNIT value for meter_id = NoSuchMeter. This meter is ignored. General Exception. Exception message below:
2020-09-14 16:13:15,118 ERROR com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Unable to fetch UNIT.
java.lang.NullPointerException: null
	at com.cts.customerGateway.CheckMeterInCustomer.hasCustomerEntry(CheckMeterInCustomer.java:80)
	at com.cts.customerGateway.CheckMeterInCustomer.getDistinctMetersInCustomer(CheckMeterInCustomer.java:59)
	at com.cts.customerGateway.CheckMeterInCustomer.filterInputRows(CheckMeterInCustomer.java:40)
	at com.cts.customerGateway.CheckMeterInCustomer.<init>(CheckMeterInCustomer.java:33)
	at com.cts.generator.ProcessInput.excludeMetersNotInCustomer(ProcessInput.java:88)
	at com.cts.generator.ProcessInput.<init>(ProcessInput.java:67)
	at com.cts.controller.Controller.printOutput(Controller.java:207)
	at com.cts.controller.Controller.startProgram(Controller.java:143)
	at com.cts.controller.Controller.execute(Controller.java:114)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-09-14 16:13:15,118 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] So far checked 2 meters. Out of which 1 has Customer entry.
2020-09-14 16:13:15,119 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Time to check 2 meters =  0 seconds.
2020-09-14 16:13:15,119 INFO com.cts.customerGateway.CheckMeterInCustomer [scheduling-1] Completed check for entry in Customer, found 1 meters which have a Customer record.
2020-09-14 16:13:15,119 INFO com.cts.generator.ProcessInput [scheduling-1] proceeding to process 1 input rows.
2020-09-14 16:13:15,119 INFO com.cts.generator.ProcessInput [scheduling-1] Getting necessary details for circutorPLCFormat.
2020-09-14 16:13:15,123 INFO com.cts.generator.ProcessInput [scheduling-1] Necessary details collected for 1 meters out of 1 meters received.
2020-09-14 16:13:15,127 INFO com.cts.utils.ExcludePulseCounters [scheduling-1] Getting list of pulse counters to be excluded.
2020-09-14 16:13:15,127 INFO com.cts.generator.ProcessInput [scheduling-1] Will process 1 records for gs2 file - circutorPLCFormat.
2020-09-14 16:13:15,574 INFO com.cts.generator.GeneratorForLastHourlyStand [scheduling-1] There are missing 4018 day stands for meter 12163501. Last stand date from DB is 2007-04-01T00:00:00.000+02:00, current stand date is 2018-04-01T00:00:00.000+02:00. Will create day stands for 4018 days.
2020-09-14 16:13:15,701 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Creating file for stand per hour for circutorPLCFormat.
2020-09-14 16:13:16,009 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Starting to check for Customer record.
2020-09-14 16:13:16,025 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Could not find meter 12163501 in the base of previously checked meters, will try to get details by API call to ISCU.
2020-09-14 16:13:16,026 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Getting details For meter_id 12163501.
2020-09-14 16:13:16,026 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Full URL to the API is: https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/12163501
2020-09-14 16:13:16,026 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] UserName is dro.
2020-09-14 16:13:16,027 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] PassWord is Sismaoffice39.
2020-09-14 16:13:16,028 INFO com.cts.customerGateway.MeterSetupClient [scheduling-1] Executing: return yafrRestTemplate.getForEntity(https://juniorgorg10.infosynergi.no:9061/iscustomer/api/metersetups/12163501, MeterSetupV2.class).getBody();
2020-09-14 16:13:16,179 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Got meter details for meter 12163501, lev_punkt_id 2979 from ISCU.
2020-09-14 16:13:16,180 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] will try to insert meter 12163501, deliveryPoint 2979,to local H2 database.
2020-09-14 16:13:16,183 INFO com.cts.customerGateway.GetDeliveryPoint [scheduling-1] Inserted meter 12163501, lev_punkt_id 2979 to the H2 database.
2020-09-14 16:13:16,184 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Meter = 12163501, Objectid = 2979 - Gap of 96432 hours between last available stand_hour 2007-04-01T00:00:00.000+02:00 and current input hour 2018-04-01T00:00:00.000+02:00.
2020-09-14 16:13:16,185 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Last stand before the gap = 409.580, current stand after the gap = 76086.000.
2020-09-14 16:13:16,185 INFO com.cts.generator.GeneratorForStandPerHourForCircutorPLCFormat [scheduling-1] Will fill the gap by equal distribution of total consumption in the gap divided by number of hours in the gap.
2020-09-14 16:13:16,279 INFO com.cts.generator.ProcessInput [scheduling-1] Created hourlyVolume GS2 file from input.
2020-09-14 16:13:16,280 INFO com.cts.generator.ProcessInput [scheduling-1] Input file contains 1 un-processable rows. Will write deviation report for those rows.
2020-09-14 16:13:16,282 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Starting writeOutput to print LastHourlyStand.
2020-09-14 16:13:16,322 INFO com.cts.ioutils.OutputFileWriter [scheduling-1] Completed writeOutput.
2020-09-14 16:13:16,323 INFO com.cts.controller.Controller [scheduling-1] GS2 file for input file Test_circutorplc_API_TimestampRead_1600092786131.txt written to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Processed\.
2020-09-14 16:13:16,325 INFO com.cts.ioutils.DeviationReportWriter [scheduling-1] Publish Deviation Report = TRUE
2020-09-14 16:13:16,329 INFO com.cts.ioutils.DeviationReportWriter [scheduling-1] AvviksRapport skrevet til: C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Failed\Test_circutorplc_API_Failed_1600092786131.txt
2020-09-14 16:13:16,330 INFO com.cts.controller.Controller [scheduling-1] Starting to move used input files to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Used\.
2020-09-14 16:13:16,336 INFO com.cts.utils.MoveUsedInputFilesToUsedFolder [scheduling-1] Test_circutorplc_API_TimestampRead_1600092786131.txt moved to C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_1\Used\ .
2020-09-14 16:13:16,336 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 10 seconds.
2020-09-14 16:13:16,337 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
2020-09-14 16:13:16,337 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_2.
2020-09-14 16:13:16,339 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,339 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for circutorPLCFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC\Borettslag_3.
2020-09-14 16:13:16,341 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,341 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\CircutorPLC in 10 seconds.
2020-09-14 16:13:16,341 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk.
2020-09-14 16:13:16,341 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\ for existing sub-directories.
2020-09-14 16:13:16,344 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for forbruksImportFormat - one for each meter data collection system .
2020-09-14 16:13:16,345 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_1.
2020-09-14 16:13:16,346 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,346 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_2.
2020-09-14 16:13:16,348 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,348 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for forbruksImportFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk\Borettslag_3.
2020-09-14 16:13:16,349 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,349 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\Forbruk in 10 seconds.
2020-09-14 16:13:16,349 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV.
2020-09-14 16:13:16,350 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\ for existing sub-directories.
2020-09-14 16:13:16,352 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VBVFormat - one for each meter data collection system .
2020-09-14 16:13:16,352 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_1.
2020-09-14 16:13:16,354 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,354 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_2.
2020-09-14 16:13:16,356 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,356 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VBVFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV\Borettslag_3.
2020-09-14 16:13:16,357 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,358 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVBV in 10 seconds.
2020-09-14 16:13:16,358 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT.
2020-09-14 16:13:16,358 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\ for existing sub-directories.
2020-09-14 16:13:16,360 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for VTFormat - one for each meter data collection system .
2020-09-14 16:13:16,360 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_1.
2020-09-14 16:13:16,362 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,362 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_2.
2020-09-14 16:13:16,363 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,363 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for VTFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT\Borettslag_3.
2020-09-14 16:13:16,364 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,364 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\KamstrupVT in 10 seconds.
2020-09-14 16:13:16,365 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus.
2020-09-14 16:13:16,365 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\ for existing sub-directories.
2020-09-14 16:13:16,368 INFO com.cts.controller.Controller [scheduling-1] Found 5 sub-folders for mBusFormat - one for each meter data collection system .
2020-09-14 16:13:16,368 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_1.
2020-09-14 16:13:16,370 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,370 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_2.
2020-09-14 16:13:16,371 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,371 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Borettslag_3.
2020-09-14 16:13:16,372 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,372 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Paradishagen.
2020-09-14 16:13:16,373 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,374 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for mBusFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus\Test.
2020-09-14 16:13:16,375 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,375 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\M-bus in 10 seconds.
2020-09-14 16:13:16,376 INFO com.cts.controller.Controller [scheduling-1] Scanning for sub directories for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde.
2020-09-14 16:13:16,376 INFO com.cts.utils.GetListOfSubDirectories [scheduling-1] Scanning C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\ for existing sub-directories.
2020-09-14 16:13:16,378 INFO com.cts.controller.Controller [scheduling-1] Found 3 sub-folders for gamleAnleggFormat - one for each meter data collection system .
2020-09-14 16:13:16,378 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_1.
2020-09-14 16:13:16,379 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,379 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_2.
2020-09-14 16:13:16,381 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,381 INFO com.cts.controller.Controller [scheduling-1] Scanning for new input file/s for gamleAnleggFormat in C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde\Borettslag_3.
2020-09-14 16:13:16,382 INFO com.cts.controller.Controller [scheduling-1] Found 0 new input file/s.
2020-09-14 16:13:16,382 INFO com.cts.controller.Controller [scheduling-1] Completed processing C:\Users\ronend\Desktop\BKKE_BASE_FOLDER\QKunde in 10 seconds.
2020-09-14 16:13:16,382 INFO com.cts.controller.Controller [scheduling-1] Completed processing in 10 seconds.
2020-09-14 16:13:16,382 INFO com.cts.controller.Controller [scheduling-1] Scan for new input files will be performed in 10 minutes according to scheduling plan.
